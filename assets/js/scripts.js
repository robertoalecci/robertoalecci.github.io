const tooltips=document.querySelectorAll(".tooltip");tooltips.forEach((i=>{i.querySelector("[data-tip]").addEventListener("click",(n=>{n.stopPropagation(),tooltips.forEach((i=>i.classList.remove("active"))),i.classList.toggle("active")}))})),document.addEventListener("click",(()=>tooltips.forEach((i=>i.classList.remove("active"))))),document.addEventListener("keydown",(i=>{"Escape"===i.key&&tooltips.forEach((i=>i.classList.remove("active")))}));const{createApp:createApp,ref:ref,watch:watch,onMounted:onMounted}=Vue;createApp({setup(){const i=ref("com"),n=ref(!1),o=ref(!1),e=ref({commissioni:{capitale:null,anni:null,commissioni:2.5,rendimento:8},inflazione:{capitale:null,anni:null,inflazione:2,rendimento:8}}),t=ref({commissioni:{investimentoSenzaCommissioni:"€ 0,00",investimentoConCommissioni:"€ 0,00",costoTotaleCommissioni:"€ 0,00",crescitaSenzaCommissioni:"0%",crescitaConCommissioni:"0%",capitalePerso:"0%"},inflazione:{capitaleInvestito:"€ 0,00",capitaleNonInvestito:"€ 0,00",costoCapitale:"€ 0,00"}});function a(i,n="€"){return"number"!=typeof i||isNaN(i)?n+" 0,00":n+" "+new Intl.NumberFormat("it-IT",{minimumFractionDigits:2,maximumFractionDigits:2}).format(i)}return onMounted((()=>{const i=new Image;i.src="././assets/images/disciplina-finanziaria-logo.png";const n={id:"watermark",beforeDraw:n=>{if(!i.complete)return;const o=n.ctx,{width:e,height:t}=n;o.save(),o.globalAlpha=.08,o.translate(e/2,t/2);const a=Math.min(e/i.width,t/i.height)/2,s=i.width*a,l=i.height*a;o.drawImage(i,-s/2,-l/2,s,l),o.restore()}},o=document.getElementById("is-commissioni-chart");chartCommissioni=new Chart(o,{type:"line",data:{labels:[],datasets:[{label:"Senza commissioni",data:[],borderColor:"#1BC47D",borderWidth:2,fill:!1},{label:"Con commissioni",data:[],borderColor:"#F51212",borderWidth:2,backgroundColor:"rgba(255,0,0,0.2)",fill:"-1"}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{labels:{usePointStyle:!0,pointStyle:"line",boxWidth:12,color:"black",font:{size:14,weight:"bold"}}},tooltip:{callbacks:{title:function(){return""},label:function(i){return i.dataset.label+": "+i.parsed.y.toLocaleString("it-IT",{style:"currency",currency:"EUR",maximumFractionDigits:0})}}}},scales:{x:{title:{display:!0,text:"Anni",font:{weight:"bold",size:14}}},y:{title:{display:!0,text:"Valore (€)",font:{weight:"bold",size:14}},ticks:{callback:i=>i.toLocaleString("it-IT",{maximumFractionDigits:0})}}}},plugins:[n]});const e=document.getElementById("is-inflazioni-chart");chartInflazioni=new Chart(e,{type:"line",data:{labels:[],datasets:[{label:"Capitale investisto",data:[],borderColor:"#1BC47D",borderWidth:2,fill:!1},{label:"Capitale fermo",data:[],borderColor:"#F51212",borderWidth:2,backgroundColor:"rgba(255,0,0,0.2)",fill:"-1"}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{labels:{usePointStyle:!0,pointStyle:"line",boxWidth:12,color:"black",font:{size:14,weight:"bold"}}},tooltip:{callbacks:{title:function(){return""},label:function(i){return i.dataset.label+": "+i.parsed.y.toLocaleString("it-IT",{style:"currency",currency:"EUR",maximumFractionDigits:0})}}}},scales:{x:{title:{display:!0,text:"Anni",font:{weight:"bold",size:14}}},y:{title:{display:!0,text:"Valore (€)",font:{weight:"bold",size:14}},ticks:{callback:i=>i.toLocaleString("it-IT",{maximumFractionDigits:0})}}}},plugins:[n]})})),watch(e,(i=>{if(i.commissioni.capitale>1e6&&(i.commissioni.capitale=1e6),i.commissioni.anni>50&&(i.commissioni.anni=50),i.commissioni.commissioni>15&&(i.commissioni.commissioni=15),i.commissioni.rendimento>15&&(i.commissioni.rendimento=15),i.commissioni.capitale<0&&(i.commissioni.capitale=0),i.commissioni.anni<0&&(i.commissioni.anni=0),i.commissioni.commissioni<0&&(i.commissioni.commissioni=0),i.commissioni.rendimento<0&&(i.commissioni.rendimento=0),i.commissioni.capitale&&i.commissioni.anni){const s=function(i,n,o,e){const t=i*Math.pow(1+n/100,e);let s=i,l=0;for(let i=1;i<=e;i++){s*=1+n/100;const i=s*(o/100);l+=i,s-=i}return{investimentoSenzaCommissioni:a(t),investimentoConCommissioni:a(s),costoTotaleCommissioni:a(l),valoreFinaleSenza:t,valoreFinaleCon:s}}(i.commissioni.capitale,i.commissioni.rendimento,i.commissioni.commissioni,i.commissioni.anni);t.value.commissioni=s;const{senza:l,conComm:c}=function(i,n,o,e){const t=[],a=[];let s=i;for(let l=0;l<=e;l++)t.push(i*Math.pow(1+n/100,l)),l>0&&(s*=1+n/100,s-=s*(o/100)),a.push(s);return{senza:t,conComm:a}}(i.commissioni.capitale,i.commissioni.rendimento,i.commissioni.commissioni,i.commissioni.anni),m=i.commissioni.rendimento,r=(n=i.commissioni.capitale,o=s.valoreFinaleCon,e=i.commissioni.anni,n&&e?100*(Math.pow(o/n,1/e)-1):0),d=(s.valoreFinaleSenza-s.valoreFinaleCon)/s.valoreFinaleSenza*100;t.value.commissioni.crescitaSenzaCommissioni=m.toFixed(1)+"%",t.value.commissioni.crescitaConCommissioni=r.toFixed(1)+"%",t.value.commissioni.capitalePerso=d.toFixed(1)+"%",chartCommissioni&&(chartCommissioni.data.labels=Array.from({length:i.commissioni.anni+1},((i,n)=>n)),chartCommissioni.data.datasets[0].data=l,chartCommissioni.data.datasets[1].data=c,chartCommissioni.data.datasets[0].label=`Senza commissioni (${m.toFixed(1)}%)`,chartCommissioni.data.datasets[1].label=`Con commissioni (${r.toFixed(1)}%)`,chartCommissioni.update())}var n,o,e;if(i.inflazione.capitale>1e6&&(i.inflazione.capitale=1e6),i.inflazione.anni>50&&(i.inflazione.anni=50),i.inflazione.inflazione>15&&(i.inflazione.inflazione=15),i.inflazione.rendimento>15&&(i.inflazione.rendimento=15),i.inflazione.capitale<0&&(i.inflazione.capitale=0),i.inflazione.anni<0&&(i.inflazione.anni=0),i.inflazione.inflazione<0&&(i.inflazione.inflazione=0),i.inflazione.rendimento<0&&(i.inflazione.rendimento=0),i.inflazione.capitale&&i.inflazione.anni){t.value.inflazione=function(i,n,o,e){const t=i*Math.pow(1+o/100,e),s=i/Math.pow(1+n/100,e);return{capitaleInvestito:a(t),capitaleNonInvestito:a(s),costoCapitale:a(t-s)}}(i.inflazione.capitale,i.inflazione.inflazione,i.inflazione.rendimento,i.inflazione.anni);const{investito:n,nonInvestito:o}=function(i,n,o,e){const t=[],a=[];for(let s=0;s<=e;s++)t.push(i*Math.pow(1+o/100,s)),a.push(i/Math.pow(1+n/100,s));return{investito:t,nonInvestito:a}}(i.inflazione.capitale,i.inflazione.inflazione,i.inflazione.rendimento,i.inflazione.anni);chartInflazioni&&(chartInflazioni.data.labels=Array.from({length:i.inflazione.anni+1},((i,n)=>n)),chartInflazioni.data.datasets[0].data=n,chartInflazioni.data.datasets[1].data=o,chartInflazioni.data.datasets[0].label=`Investito (${i.inflazione.rendimento.toFixed(1)}%)`,chartInflazioni.data.datasets[1].label=`Non investito (inflazione ${i.inflazione.inflazione.toFixed(1)}%)`,chartInflazioni.update())}}),{deep:!0}),watch(i,(i=>{})),{activeTab:i,form:e,results:t,comCapitaleFocus:n,infCapitaleFocus:o}}}).mount("#is-app");